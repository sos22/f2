#ifndef RPCSERVICE_TMPL__
#define RPCSERVICE_TMPL__

template <typename t, typename ... args> orerror<t *>
rpcservice::listen(const peername &listenon,
                   const rpcserviceconfig &config,
                   args && ... params) {
    auto fd(rpcservice::open(listenon));
    if (fd.isfailure()) return fd.failure();
    auto res(new t(constoken(fd.success(), config),
                   std::forward<args>(params)...));
    res->startrootthread();
    return res; }

template <typename t> rpcservice::response &
rpcservice::response::addparam(wireproto::parameter<t> p, const t &v) {
    inner.addparam(p, v);
    return *this; }

#endif /* !RPCSERVICE_TMPL__ */
